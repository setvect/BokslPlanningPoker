# 플래닝 포커 구현 단계

## 📋 프로젝트 개요

**목표**: 웹 기반 플래닝 포커 애플리케이션 개발  
**기술스택**: Node.js + TypeScript (백엔드), React + TypeScript (프론트엔드), Socket.io (실시간 통신)  
**진행방식**: 5단계 점진적 구현 → 세부 구현 단계

---

## ✅ 완료된 단계 (Stage 1-5)

### **Stage 1: 프로젝트 초기 설정** ✅
- [x] 프로젝트 디렉토리 구조 생성
- [x] Git 저장소 초기화
- [x] 기본 문서 작성 (기능요구사항.md, 기술스택.md)

### **Stage 2: 백엔드 기본 설정** ✅
- [x] `server/` 디렉토리 생성
- [x] package.json 설정 (Express, Socket.io, TypeScript)
- [x] tsconfig.json 구성
- [x] 기본 Express 서버 구조

### **Stage 3: 프론트엔드 기본 설정** ✅
- [x] `client/` 디렉토리 생성 (Vite + React)
- [x] package.json 설정 (React, TypeScript, Tailwind CSS)
- [x] Vite 및 Tailwind 설정
- [x] 기본 React 애플리케이션 구조

### **Stage 4: 공통 타입 정의** ✅
- [x] `shared/` 디렉토리 생성
- [x] types.ts - 공통 데이터 타입 정의
- [x] socket-events.ts - Socket.io 이벤트 정의
- [x] constants.ts - 게임 설정 상수
- [x] index.ts - 통합 export

### **Stage 5: 핵심 로직 구현** ✅

#### **5-1: 서버 Socket.io 이벤트 핸들러** ✅
**파일**: `server/src/socket/handlers.ts`

**구현 내용**:
- GameStore 클래스 (메모리 기반 데이터 저장)
- 방 생성/입장 로직
- 사용자 이름 중복 처리 (자동 번호 추가)
- 카드 선택/공개 메커니즘
- 평균값 계산 (숫자 카드만)
- 라운드 초기화 기능
- 실시간 브로드캐스트

**검증 완료**:
- [x] TypeScript 컴파일 성공
- [x] Socket.io 이벤트 핸들러 등록
- [x] 서버 빌드 성공 (`npm run build`)

#### **5-2: 클라이언트 Socket.io 연결** ✅
**파일들**:
- `client/src/hooks/useSocket.ts`
- `client/src/hooks/useGame.ts`
- `client/src/App.tsx` (업데이트)

**구현 내용**:
- useSocket 훅 (Socket.io 연결 관리)
- useGame 훅 (게임 상태 관리)
- Promise 기반 API (create/join/leave room)
- 실시간 이벤트 리스너
- 로딩/에러 상태 처리
- localStorage 사용자명 저장

**검증 완료**:
- [x] TypeScript 컴파일 성공
- [x] React 컴포넌트 렌더링
- [x] 클라이언트 빌드 성공 (`npm run dev`)

### **공통 이슈 해결** ✅
- [x] shared 디렉토리 정리 (컴파일된 파일 제거)
- [x] TypeScript 경로 설정 문제 해결
- [x] .cursorrules 파일 생성 (프로젝트 가이드라인)

---

## 🚀 진행 예정 단계 (Stage 6-10)

### **Stage 6: 통합 테스트 및 기본 동작 검증**

#### **6-1: 서버-클라이언트 연결 테스트**
**목표**: Socket.io 연결이 정상 작동하는지 확인

**작업내용**:
- 개발 서버 동시 실행 (서버 3001포트, 클라이언트 5173포트)
- Socket.io 연결 상태 확인
- 기본 이벤트 송수신 테스트

**체크포인트**:
```bash
# 서버 실행 (터미널 1)
cd server && npm run dev
# ✅ "Server running on port 3001" 메시지 확인
# ✅ Socket.io 초기화 메시지 확인

# 클라이언트 실행 (터미널 2) 
cd client && npm run dev
# ✅ "Local: http://localhost:5173" 접속 가능
# ✅ 브라우저 개발자도구에서 Socket.io 연결 로그 확인
# ✅ 연결 상태 UI에 "연결됨" 표시
```

**검증 기준**:
- [x] 서버 정상 시작 및 포트 리스닝
- [x] 클라이언트 Socket.io 연결 성공
- [x] 브라우저 콘솔에 연결 로그 확인
- [x] 네트워크 탭에서 WebSocket 연결 확인

#### **6-2: 방 생성/입장 플로우 테스트**
**목표**: 기본 방 관리 기능 검증

**테스트 시나리오**:
1. 브라우저 1: 방 생성 (방 이름 입력)
2. 브라우저 2: 같은 방 입장
3. 동일 이름으로 입장 시 자동 번호 추가 확인

**체크포인트**:
- [x] 방 생성 시 고유 ID 생성 확인
- [x] 사용자 이름 입력 후 방 입장 성공
- [x] 중복 이름 처리 (김철수 → 김철수(2)) 동작
- [x] 방 정보가 실시간으로 업데이트되는지 확인
- [x] 브라우저 새로고침 시 재연결 동작

---

### **Stage 7: 게임 UI 컴포넌트 개발**

#### **7-1: 카드 선택 UI 구현**
**목표**: 플래닝 포커 카드 덱과 선택 인터페이스

**작업내용**:
- 14장 카드 그리드 레이아웃 (반응형)
- 카드 선택 상태 시각화
- 터치 친화적 디자인
- Tailwind CSS 스타일링

**카드 덱**: `['0', '1/2', '1', '2', '3', '5', '8', '13', '20', '40', '60', '100', '?', '커피']`

**체크포인트**:
```bash
# 컴포넌트 렌더링 확인
cd client && npm run dev
```
- [x] 모든 카드 정확한 표시
- [x] 모바일(320px)/태블릿(768px)/데스크톱(1024px+) 반응형
- [x] 카드 클릭 시 선택 상태 하이라이트
- [x] 선택된 카드 변경 가능
- [x] 터치 영역 최소 44px 확보

#### **7-2: 참여자 목록 UI 구현**
**목표**: 실시간 참여자 상태 표시

**생성 파일**: `client/src/components/PlayerList.tsx`

**작업내용**:
- 참여자별 카드 선택 상태 표시
- 온라인/오프라인 상태 표시
- 실시간 업데이트 처리

**체크포인트**:
- [x] 참여자 이름과 상태 실시간 업데이트
- [x] 카드 선택 완료/미완료 구분 표시 (✅/⏳)
- [x] 다중 브라우저 탭에서 동기화 확인
- [x] 사용자 입장/퇴장 즉시 반영

#### **7-3: 게임 결과 UI 구현**
**목표**: 카드 오픈 후 결과 표시

**생성 파일**: `client/src/components/GameResult.tsx`

**작업내용**:
- 모든 카드 동시 공개 애니메이션
- 평균값 계산 및 표시
- 개별 선택 카드 표시

**체크포인트**:
- [ ] 카드 오픈 시 모든 선택 카드 동시 표시
- [ ] 숫자 카드만으로 평균 계산 (?, 커피 제외)
- [ ] 시각적으로 명확한 결과 표시
- [ ] 평균값 소수점 1자리까지 표시

---

### **Stage 8: 게임 플로우 완성**

#### **8-1: 게임 상태 관리 통합**
**목표**: 완전한 게임 사이클 구현

**작업내용**:
- 선택 → 오픈 → 초기화 전체 플로우
- 게임 상태 전환 로직 완성
- 자동/수동 카드 오픈 구현

**게임 상태**: `SELECTING` → `REVEALED` → `FINISHED`

**체크포인트**:
```bash
# 멀티 브라우저 테스트
# 브라우저 1: 방 생성 후 대기
# 브라우저 2: 같은 방 입장
```
- [ ] 두 사용자가 모두 카드 선택 완료 시 자동 오픈 버튼 활성화
- [ ] 한 명이 오픈 버튼 클릭 시 모든 사용자에게 결과 표시
- [ ] 라운드 초기화 후 새로운 선택 가능
- [ ] 게임 상태 변경 시 모든 클라이언트 동기화

#### **8-2: 실시간 동기화 검증**
**목표**: 모든 이벤트의 실시간 동기화 확인

**테스트 시나리오**:
1. 5명이 동시 접속하여 카드 선택
2. 네트워크 끊김 후 재연결
3. 브라우저 새로고침 후 상태 복구

**체크포인트**:
- [ ] 사용자 입장/퇴장 즉시 반영
- [ ] 카드 선택 상태 실시간 업데이트
- [ ] 게임 상태 변경 모든 클라이언트 동기화
- [ ] 네트워크 끊김 후 재연결 시 상태 복구
- [ ] 동시 다중 사용자 액션 처리

---

### **Stage 9: 사용자 경험 개선**

#### **9-1: 에러 처리 및 사용자 피드백**
**목표**: 안정적인 사용자 경험 제공

**작업내용**:
- 연결 끊김/재연결 UI 표시
- 로딩 상태 인디케이터
- 사용자 친화적 에러 메시지 (한국어)

**체크포인트**:
- [ ] 네트워크 끊김 시 "연결 중..." 표시
- [ ] 방 가득참(20명) 시 안내 메시지
- [ ] 잘못된 방 ID 접근 시 처리
- [ ] Socket.io 재연결 로직 동작
- [ ] 에러 메시지 한국어로 표시

#### **9-2: 반응형 디자인 최적화**
**목표**: 모든 기기에서 최적의 사용성

**작업내용**:
- 모바일 우선 설계
- 터치 친화적 인터페이스
- 다크 모드 호환성

**체크포인트**:
```bash
# 다양한 해상도 테스트
# Chrome 개발자도구 > Device Toolbar
```
- [ ] 모바일 (320px~767px): 세로 스택 레이아웃
- [ ] 태블릿 (768px~1023px): 컴팩트 그리드
- [ ] 데스크톱 (1024px+): 와이드 레이아웃
- [ ] 터치 영역 최소 44px 확보
- [ ] 다크 모드에서 적절한 색상 대비

#### **9-3: 애니메이션 및 마이크로 인터랙션**
**목표**: 부드럽고 직관적인 인터페이스

**작업내용**:
- CSS 전환 효과 추가
- 카드 공개 애니메이션
- 호버/포커스 피드백

**체크포인트**:
- [ ] 카드 선택 시 부드러운 전환 효과 (0.2s ease)
- [ ] 카드 오픈 시 순차적 공개 애니메이션
- [ ] 호버/포커스 상태 명확한 피드백
- [ ] 로딩 스피너 및 페이드 인/아웃 효과

---

### **Stage 10: 최종 테스트 및 배포 준비**

#### **10-1: 종합 기능 테스트**
**목표**: 전체 시스템 안정성 검증

**테스트 시나리오**:
```bash
# 다중 사용자 테스트 (5명 이상)
# 브라우저별 호환성 (Chrome, Firefox, Safari, Edge)
# 네트워크 상황별 테스트 (느린 연결, 끊김/재연결)
```

**체크포인트**:
- [ ] 동시 접속 20명 테스트 (부하 테스트)
- [ ] 장시간 사용 시 메모리 누수 없음
- [ ] 1시간 비활성 방 자동 정리 동작
- [ ] 모든 주요 브라우저에서 정상 동작
- [ ] 모바일 Safari, Chrome 호환성

#### **10-2: 성능 최적화**
**목표**: 빠른 로딩과 부드러운 실행

**최적화 영역**:
- React 컴포넌트 최적화 (React.memo, useCallback)
- Socket.io 이벤트 최적화
- 번들 크기 최적화

**체크포인트**:
- [ ] 초기 로딩 시간 3초 이내
- [ ] 카드 선택 반응 시간 100ms 이내
- [ ] Socket.io 이벤트 지연 최소화 (< 50ms)
- [ ] 번들 크기 1MB 이하
- [ ] Lighthouse 성능 점수 90+ 달성

#### **10-3: 배포 환경 구성**
**목표**: 프로덕션 배포 준비

**작업내용**:
- Dockerfile 작성
- 환경 변수 설정
- HTTPS 및 보안 설정
- fly.io 배포 스크립트

**생성 파일들**:
- `Dockerfile`
- `docker-compose.yml`
- `fly.toml`

**체크포인트**:
```bash
# 프로덕션 빌드 테스트
npm run build
docker build -t planning-poker .
docker run -p 3001:3001 planning-poker
```
- [ ] Docker 컨테이너 정상 빌드
- [ ] 프로덕션 환경에서 모든 기능 동작
- [ ] HTTPS 설정 및 보안 헤더 적용
- [ ] 환경 변수 설정 완료
- [ ] fly.io 배포 성공

---

## 🔍 검증 도구 및 방법

### **자동화된 체크**
```bash
# 전체 빌드 체크
cd server && npm run build
cd ../client && npm run build

# 타입 체크
cd server && npx tsc --noEmit
cd ../client && npx tsc --noEmit

# 개발 서버 동시 실행
# 터미널 1: cd server && npm run dev
# 터미널 2: cd client && npm run dev
```

### **수동 테스트 체크리스트**
각 단계마다 다음 항목들을 수동으로 확인:

**기능 테스트**:
- [ ] 방 생성/입장/퇴장
- [ ] 카드 선택/변경/오픈
- [ ] 라운드 초기화
- [ ] 실시간 동기화

**호환성 테스트**:
- [ ] Chrome, Firefox, Safari, Edge
- [ ] 모바일, 태블릿, 데스크톱
- [ ] 다양한 네트워크 상황

**성능 테스트**:
- [ ] 로딩 속도
- [ ] 반응성
- [ ] 메모리 사용량
- [ ] 동시 사용자 처리

---

## 📅 예상 일정

| 단계 | 예상 소요시간 | 누적 시간 |
|------|---------------|-----------|
| Stage 6 | 4시간 | 4시간 |
| Stage 7 | 8시간 | 12시간 |
| Stage 8 | 6시간 | 18시간 |
| Stage 9 | 6시간 | 24시간 |
| Stage 10 | 4시간 | 28시간 |

**총 예상 개발 시간**: 약 28시간 (3-4일)

---

## 🎯 다음 단계

현재 Stage 5까지 완료된 상태에서, **Stage 6-1 (서버-클라이언트 연결 테스트)**부터 시작하여 단계별로 진행합니다.

각 단계 완료 후 체크포인트를 확인하고, 문제가 있으면 해결 후 다음 단계로 진행하는 방식으로 안정적인 개발을 진행합니다. 