# 플래닝 포커 기능 요구사항

## 📋 프로젝트 개요

**목적**: 최소한의 기능을 가진 웹 기반 플래닝 포커 도구 개발

**핵심 원칙**:
- 최대한 간단하게 구현
- DBMS 이용 없음 (메모리 기반)
- 로그인/인증 시스템 없음

---

## 🎯 핵심 기능

### 1. 카드 시스템
- **카드 덱**: `0, 1/2, 1, 2, 3, 5, 8, 13, 20, 40, 60, 100, ?, 커피`
- **특수 카드**:
  - `?`: 정보 부족으로 추정 불가
  - `커피`: 휴식 필요
- **평균 계산**: 숫자 카드만 포함 (?, 커피, 미선택 제외)

### 2. 방 관리
- **방 생성**: 방 이름 입력으로 생성
- **방 제한**: 최대 10개 방 동시 운영
- **인원 제한**: 방당 최대 20명
- **자동 정리**: 
  - **비활성 판단**: 1시간 동안 아무런 게임 액션이 없는 방
  - **감지 액션**: 카드 선택/변경, 카드 오픈, 라운드 초기화
  - **정리 주기**: 5분마다 배치 작업으로 비활성 방 삭제
- **직접 접속**: 방별 고유 URL 제공

### 3. 사용자 관리
- **이름 입력**: 방 입장 시 이름 설정
- **이름 저장**: 쿠키에 저장하여 재입장 시 자동 입력
- **이름 변경**: 방 내에서 언제든 변경 가능
- **중복 처리**: 같은 방 내 동일 이름 허용 (번호 자동 추가)

---

## 🎮 게임 플로우

### Phase 1: 카드 선택
1. 참여자들이 각자 카드를 비밀리에 선택
2. **선택 상태 표시**: 누가 선택했는지만 표시 (카드 내용 숨김)
3. **카드 수정**: 오픈 전까지 자신의 카드 변경 가능

### Phase 2: 카드 오픈
1. **오픈 조건**: 
   - 모든 참여자가 카드 선택 완료 시 자동 오픈 버튼 활성화
   - 또는 방에 있는 누구나 강제 오픈 가능
2. **결과 표시**: 
   - 모든 카드 동시 공개
   - 평균값 자동 계산 및 표시
   - 참여자별 선택 카드 표시

### Phase 3: 라운드 관리
1. **라운드 초기화**: 새로운 추정을 위한 카드 리셋
2. **연속 플레이**: 여러 스토리 연속 추정 가능

---

## 🖥️ 사용자 인터페이스

### 반응형 웹 디자인
- **브라우저 해상도 대응**: 데스크톱, 태블릿, 모바일 모든 해상도 지원
- **적응형 레이아웃**: 화면 크기에 따라 UI 구성 요소 자동 조정
- **터치 친화적**: 모바일에서 손가락으로 조작하기 쉬운 버튼 크기
- **가독성 보장**: 모든 기기에서 텍스트와 버튼의 적절한 크기 유지

### 메인 화면
- **방 생성**: 방 이름 입력 폼
- **방 목록**: 현재 활성화된 방들 (선택사항)
- **빠른 접속**: URL을 통한 직접 방 접속

### 방 내부 화면
- **참여자 목록**: 
  - 현재 방에 있는 모든 사용자
  - 각 참여자의 카드 선택 상태 (선택함/미선택)
  - 온라인/오프라인 상태 표시
- **카드 선택 영역**: 
  - 사용 가능한 모든 카드 표시
  - 선택된 카드 하이라이트
  - **반응형 카드 그리드**: 화면 크기에 따라 카드 배치 자동 조정
- **게임 상태 표시**:
  - 현재 라운드 상태 (선택 중/오픈됨)
  - 선택 완료 인원 수
- **결과 영역**: 
  - 오픈된 카드들
  - 평균값 및 통계
- **컨트롤 버튼**:
  - 카드 오픈
  - 라운드 초기화
  - 이름 변경
  - 방 나가기
  - **모바일 최적화**: 터치하기 쉬운 크기와 간격

---

## 🔧 기술적 요구사항

### 실시간 통신
- **웹소켓**: 모든 상태 변경 실시간 동기화
- **이벤트 처리**:
  - 카드 선택/변경
  - 사용자 입장/퇴장
  - 카드 오픈
  - 라운드 초기화

### 상태 관리
- **메모리 기반**: 서버 재시작 시 모든 데이터 초기화
- **세션 관리**: 웹소켓 연결 기반
- **정리 작업**: 
  - **비활성 방 삭제**: 1시간 동안 게임 액션이 없는 방을 5분마다 체크하여 삭제
  - **활동 추적**: 웹소켓을 통한 카드 선택, 오픈, 라운드 초기화 등의 액션 감지
  - **연결 끊김 사용자 자동 제거**: 웹소켓 연결 해제 시 즉시 처리

### 에러 처리
- **방 가득참**: 입장 차단 및 안내 메시지
- **연결 끊김**: 자동 재연결 시도
- **중복 이름**: 자동 번호 추가 (예: "복슬이(2)")

---

## 🚀 개발 요구사항

### 배포 환경
- **컨테이너화**: Docker를 활용한 빌드
- **도메인**: 간단한 서브도메인 사용

### 개발 우선순위

**Phase 1 (MVP)**:
- ✅ 방 생성/입장 기능
- ✅ 카드 선택/오픈 기능  
- ✅ 평균 계산
- ✅ 기본 웹소켓 통신
- ✅ 사용자 이름 관리

**Phase 2 (개선)**:
- ✅ 라운드 초기화 기능
- ✅ 참여자 상태 표시
- ✅ UX 개선 (애니메이션, 반응형)
- ✅ 에러 처리 강화

**Phase 3 (선택사항)**:
- 🔄 방 목록 기능
- 🔄 통계 기능 (히스토리)
- 🔄 모바일 최적화

---

## 📝 추가 고려사항

### 보안
- XSS 방지를 위한 입력값 검증
- 간단한 rate limiting (DoS 방지)

### 성능
- 동시 접속자 모니터링
- 메모리 사용량 관리

### 사용성
- **직관적인 UI/UX**: 사용자가 쉽게 이해할 수 있는 인터페이스
- **완전 반응형 디자인**: 
  - 데스크톱 (1920px+): 와이드 레이아웃, 사이드바 형태
  - 태블릿 (768px-1919px): 컴팩트 레이아웃
  - 모바일 (320px-767px): 세로 스택 레이아웃, 큰 터치 영역
- **접근성 고려**: 키보드 네비게이션, 스크린 리더 지원 